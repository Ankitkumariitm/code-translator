<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GarunVM AI | Universal Transpiler</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/clike/clike.min.js"></script>

    <style>
        :root { --blue: #00d2ff; --dark: #0d1117; --panel: #161b22; --border: #30363d; }
        body { margin: 0; background: var(--dark); color: #e6edf3; font-family: 'Inter', sans-serif; display: flex; flex-direction: column; height: 100vh; }
        
        header { height: 60px; background: var(--panel); border-bottom: 2px solid var(--blue); display: flex; align-items: center; padding: 0 20px; justify-content: space-between; }
        .workspace { display: flex; flex: 1; overflow: hidden; gap: 2px; background: var(--border); }
        
        .column { flex: 1; display: flex; flex-direction: column; background: var(--dark); }
        .col-label { background: #21262d; padding: 8px 15px; font-size: 11px; font-weight: bold; color: #8b949e; text-transform: uppercase; display: flex; justify-content: space-between; }
        
        .CodeMirror { flex: 1; font-size: 15px; }
        #output { height: 150px; background: #000; color: #00ff88; padding: 15px; font-family: monospace; overflow-y: auto; border-top: 2px solid var(--border); white-space: pre-wrap; }
        
        .controls { height: 70px; background: var(--panel); display: flex; align-items: center; padding: 0 20px; gap: 15px; border-top: 1px solid var(--border); }
        button { background: var(--blue); color: #000; border: none; padding: 10px 25px; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        button.ai-btn { background: #8a2be2; color: white; }
        
        select { background: #0d1117; color: white; border: 1px solid var(--border); padding: 8px; border-radius: 4px; }
    </style>
</head>
<body>

<header>
    <div style="font-weight: 800; font-size: 20px;">GARUN<span style="color:var(--blue)">AI</span></div>
    <div style="font-size: 12px; color:#8b949e;">Status: <span id="api-status" style="color:#00ff88;">AI Online</span></div>
</header>

<div class="workspace">
    <div class="column">
        <div class="col-label">
            Source Code 
            <select id="srcLang">
                <option value="c">C</option>
                <option value="cpp">C++</option>
                <option value="python">Python</option>
                <option value="java">Java</option>
            </select>
        </div>
        <div id="srcEditor"></div>
    </div>

    <div class="column">
        <div class="col-label">
            Target Code (Converted)
            <select id="targetLang">
                <option value="python">Python</option>
                <option value="java">Java</option>
                <option value="c">C</option>
                <option value="cpp">C++</option>
            </select>
        </div>
        <div id="targetEditor"></div>
    </div>
</div>

<div id="output">>>> Run or Translate results will appear here...</div>

<div class="controls">
    <button onclick="runCode()">▶ RUN SOURCE</button>
    <button class="ai-btn" onclick="translateCode()">✨ AI TRANSLATE</button>
    <div style="color: #555; font-size: 11px;">Note: Transpilation uses logic-aware AI.</div>
</div>

<script>
    let srcEditor, targetEditor;

    window.onload = () => {
        srcEditor = CodeMirror(document.getElementById("srcEditor"), {
            theme: "dracula", lineNumbers: true, mode: "text/x-csrc",
            value: "#include <stdio.h>\n\nint main() {\n    int n = 10;\n    for(int i=0; i<n; i++) {\n        printf(\"Number: %d\\n\", i);\n    }\n    return 0;\n}"
        });
        
        targetEditor = CodeMirror(document.getElementById("targetEditor"), {
            theme: "dracula", lineNumbers: true, mode: "python", readOnly: false
        });
    };

    // 1. RUN LOGIC (using Piston API)
    async function runCode() {
        const out = document.getElementById('output');
        out.innerText = "Running Source Code...\n";
        
        try {
            const resp = await fetch("https://emkc.org/api/v2/piston/execute", {
                method: "POST",
                body: JSON.stringify({
                    language: document.getElementById('srcLang').value,
                    version: "*",
                    files: [{ content: srcEditor.getValue() }]
                })
            });
            const data = await resp.json();
            out.innerText = data.run.output || data.run.stderr || "Success (No Output)";
        } catch (e) {
            out.innerText = "Error: API connection failed.";
        }
    }

    // 2. AI TRANSLATION LOGIC
    async function translateCode() {
        const out = document.getElementById('output');
        const src = document.getElementById('srcLang').value;
        const target = document.getElementById('targetLang').value;
        
        out.innerText = `AI is translating ${src} to ${target}... Please wait.\n`;
        
        // Yahan par hum ek Free AI Proxy use kar rahe hain jo code translate karti hai.
        // Asli project mein aap apni Gemini API key yahan fetch mein daal sakte hain.
        try {
            const prompt = `Convert this ${src} code to ${target} code. Only return the code, no explanation:\n\n${srcEditor.getValue()}`;
            
            // Note: Ye ek placeholder AI service hai, aap yahan Gemini API integrate kar sakte hain.
            const response = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent("https://api.deepai.org/api/text-generator"), {
                // In real production, you would use a direct LLM API call
            });
            
            // Simulated AI Logic for Demo (Since direct AI Keys are private)
            let mockTranslation = "";
            if(src === 'c' && target === 'python') {
                mockTranslation = srcEditor.getValue()
                    .replace(/#include .*/g, "")
                    .replace(/int main\(\) \{/g, "")
                    .replace(/int /g, "")
                    .replace(/printf\(/g, "print(")
                    .replace(/%d/g, "{}")
                    .replace(/for\(int i=0; i<(.*); i\+\+\) \{/g, "for i in range($1):")
                    .replace(/return 0;|\}/g, "").trim();
            } else {
                mockTranslation = "# AI Translation requires a valid API Key (Gemini/OpenAI).\n# The logic for " + src + " to " + target + " is being processed.";
            }
            
            targetEditor.setValue(mockTranslation);
            out.innerText = "Translation Complete!";
        } catch (e) {
            out.innerText = "Translation Error: Check Network.";
        }
    }
</script>
</body>
</html>